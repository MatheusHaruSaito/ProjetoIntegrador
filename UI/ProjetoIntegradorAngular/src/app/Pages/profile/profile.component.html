<div class="profile-container">

  <!-- ==== MENU LATERAL ==== -->
  <aside class="menu">
    <h3>CONFIGURAÇÕES</h3>

    <ul>
      <li class="active"><i class="fa-solid fa-circle-user"></i> Seu Perfil</li>
      <li><i class="fa-solid fa-lock"></i> Segurança e Privacidade</li>
      <li id="toggle-theme" (click)="toggleTheme()"><i class="fa-solid fa-moon"></i> Aparência</li>
      <li id="historicoBtn" class="btnHistorico"><i class="fa-solid fa-file"></i> Histórico</li>
    </ul>

    <button class="btn-logout" (click)="logout()">
      <i class="fas fa-sign-out-alt"></i> Sair
    </button>
  </aside>

  <main class="profile">

    <!-- ==== CARD DO USUÁRIO ==== -->
    <section class="profile-card">
      <div class="photo">
        <img id="ProfileImage" src="/images/user-placeholder.png" alt="Foto de Perfil">
      </div>

      <div class="info">
        <h2>{{ User.name }}</h2>

        <p class="bio">{{ User.description || 'Sem descrição adicionada.' }}</p>

        <label class="notification">
          <input type="checkbox" checked> Receber notificações
        </label>
      </div>

      <div class="profile-buttons">
        <button [routerLink]="['/EditProfile']" class="btn-profile editProfile">
          <i class="fa-solid fa-pen"></i> Editar Perfil
        </button>

        <button [routerLink]="['/Feedback']" class="btn-profile btnFeedback">
          <i class="fa-solid fa-comments"></i> Enviar feedback
        </button>
      </div>
    </section>

    <!-- ==== POSTS DO USUÁRIO ==== -->
    <section class="user-posts" *ngIf="UserPosts?.length">
      <h3>Suas publicações</h3>

      <div class="posts-grid">
        @for (post of UserPosts; track $index) {
        <div class="user-post-card" (click)="openModal(post.id)">

          <h4 class="user-post-title">{{ post.title }}</h4>

          <img *ngIf="post.postImgPath" [src]="post.postImgPath" class="user-post-thumb" alt="Miniatura">

          <p class="user-post-excerpt">
            {{ post.description }}
          </p>
        </div>
        }
      </div>
    </section>

  </main>
</div>

<!-- ==== MODAL DE POST ==== -->

<div class="modal-overlay" *ngIf="selectedPost" (click)="onOverlayClick($event)">
  <div class="modal-window" (click)="$event.stopPropagation()">

    <button class="modal-close" (click)="closeModal()">×</button>

    <div class="modal-body-vertical">

      <div class="modal-author">
        <img [src]="selectedPost.profileImgPath || 'images/user-placeholder.png'" class="modal-avatar" alt="Avatar">
        <div>
          <div class="modal-author-name">{{ selectedPost.userName }}</div>
          <div class="modal-dates">
            Criado: {{ selectedPost.createdAt | date:'short' }}
          </div>
        </div>
      </div>

      <h3 class="modal-title">{{ selectedPost.title }}</h3>

      <img *ngIf="selectedPost.postImgPath" [src]="selectedPost.postImgPath" class="modal-image-vertical" alt="Imagem">

      <p class="modal-description-long">
        {{ selectedPost.description }}
      </p>

      <div class="modal-footer">
        <button (click)="Vote(selectedPost.id); $event.stopPropagation()" class="vote-btn">
          <i class="fas fa-arrow-up"></i>
        </button>
        <span class="vote-count">{{ selectedPost.votes }}</span>
      </div>

    </div>

  </div>
</div>