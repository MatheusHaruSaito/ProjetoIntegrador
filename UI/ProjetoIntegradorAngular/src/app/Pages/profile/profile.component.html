<div class="profile-container">

  <!-- ====== MENU LATERAL ====== -->
  <aside class="menu">
    <h3>CONFIGURAÇÕES</h3>

    <ul>
      <li class="active"><i class="fa-solid fa-circle-user"></i> Seu Perfil</li>
      <li><i class="fa-solid fa-lock"></i> Segurança e Privacidade</li>
      <li id="toggle-theme" (click)="toggleTheme()"><i class="fa-solid fa-moon"></i> Aparência</li>
      <li id="historicoBtn" class="btnHistorico"><i class="fa-solid fa-file"></i> Histórico</li>
    </ul>

    <button class="btn-logout" (click)="logout()">
      <i class="fas fa-sign-out-alt"></i> Sair
    </button>
  </aside>


  <!-- ====== CONTEÚDO PRINCIPAL ====== -->
  <main class="profile">

    <!-- ====== CARD DO USUÁRIO ====== -->
    <section class="profile-card">
      <div class="photo">
        <img id="ProfileImage" src="/images/user-placeholder.png" alt="Foto de Perfil">

        <button [routerLink]="['/EditProfile']" class="editProfile">
          <i class="fa-solid fa-pen"></i> Editar Perfil
        </button>
      </div>

      <div class="info">
        <h2>{{ User.name }}</h2>

        <p class="bio">{{ User.description || 'Sem descrição adicionada.' }}</p>

        <label class="notification">
          <input type="checkbox" checked> Receber notificações
        </label>

        <button [routerLink]="['/Feedback']" class="btnFeedback">
          <i class="fa-solid fa-comments"></i> Enviar feedback
        </button>
      </div>
    </section>


    <!-- ====== POSTS DO USUÁRIO ====== -->
    <section class="user-posts" *ngIf="UserPosts?.length">
      <h3>Suas publicações</h3>

      <div class="posts-grid">
        @for (post of UserPosts; track $index) {
          <div class="user-post-card" (click)="openModal(post.id)">
            <h4>{{ post.title }}</h4>
            <p>{{ post.description }}</p>
          </div>
        }
      </div>
    </section>

  </main>
</div>


<!-- ================================================================================= -->
<!--                               MODAL DE POST (IDÊNTICO AO FEED)                   -->
<!-- ================================================================================= -->

<div class="modal-overlay" *ngIf="selectedPost" (click)="onOverlayClick($event)">
  <div class="modal-window" role="dialog" aria-modal="true">

    <button class="modal-close" (click)="closeModal()" aria-label="Fechar modal">&times;</button>

    <div class="modal-body">

      <!-- LADO ESQUERDO - IMAGEM -->
      <div class="modal-left">
        <img *ngIf="selectedPost.postImgPath; else noImage"
             [src]="selectedPost.postImgPath"
             class="modal-image"
             alt="Imagem do post">

        <ng-template #noImage>
          <div class="modal-noimage">Sem imagem</div>
        </ng-template>
      </div>

      <!-- LADO DIREITO - DETALHES -->
      <div class="modal-right">

        <!-- Autor -->
        <div class="modal-author">
          <img [src]="selectedPost.profileImgPath || 'assets/user-placeholder.png'"
                alt="Avatar"
                class="modal-avatar">

          <div>
            <div class="modal-author-name">
              {{ selectedPost.userName || ('Usuário ' + selectedPost.userId) }}
            </div>

            <div class="modal-dates">
              Criado: {{ selectedPost.createdAt | date:'short' }}
            </div>
          </div>
        </div>

        <h3 class="modal-title">{{ selectedPost.title }}</h3>

        <p class="modal-description">
          {{ selectedPost.description }}
        </p>

        <!-- VOTOS -->
        <div class="modal-footer">
          <div class="vote-section">
            <button (click)="Vote(selectedPost.id); $event.stopPropagation()" class="vote-btn upvote">
              <i class="fas fa-arrow-up"></i>
            </button>

            <span class="vote-count">{{ selectedPost.votes }}</span>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
